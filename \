import os, math, xlrd, pickle

def Ratio(data1, data2):
    """returns ratio of 2 given items """
    ratio = 0.00
    ratio = data1/ data2
    return ratio

def Ratiolist(list1, list2):
    """ returns a list of ratio's to perform operations later"""
    ratiolist = []
    for r in range(len(list1)+1):
        ratiolist.append(Ratio(list1[r], list2[r]))
    return ratiolist

def Maximum(data):
    """ returns the maximum vaue from a list"""
    maximum = max(data)
    return maximum

def Minimum(data):
    """returns the minimum value from a list"""
    minimum = min(data)
    return minimum

def MaximumRowvalue(ratiolist):
    """returns a row value which holds the maximum value of a given list"""
    row = 0
    for r in range(len(ratiolist)):
        if maximumratio == Maximum(ratiolist):
           row = r 
    return row

def location(value):
    """returns the location details of a given value"""
    return (dic[0][val])

def IsMaximumftomRatio(list_female, list_male):
    """ returns the row value which holds the maximum of female to male employment ratio""" 
    return MaximumRowvalue((Ratiolist(list_female, list_male)))

def PoepskRatio(location):
    """ returns the ratio of privately owned establishmnets to total number of eatblishments in a given location"""
    for p in range(len(list_place)):
        if list_place[p] == location:
           return Ratio(list_poepsk[r], list_Tnepsk[r])

def ExtractdatafromExcel(filename):
    """Extracts data from Excel file"""
    workbook = xlrd.open_workbook(filename)
    sheet = workbook.sheet_by_index(0)
    data = [[sheet.cell_value(r,c)for c in range(12,sheet.ncols)] for r in range(19, (sheet.nrows-4))]
    return data

def GetData(filename):
    if os.path.isfile('my_pickle'): 
       data1 = pickle.load(my_pickle)
    else:
        with open('my_pickle', 'wb') as f:
           data1 = pickle.dump(ExtractdatafromExcel(filename), f)
           dic = pickle.dump(PreprocessedData(data1), f)
    return data1       
""" Defining data structures required """    
def PreprocessedData(data1):
    data1 = ExtractdatafromExcel(filename)
    list_place = []
    list_establishments = []
    list_male = []
    list_female = []
    list_Tnepsk = []
    list_Tpepsk = []
    list_poepsk = []
    list_popepsk = []
    list_ftomratio = []
    dic = {}
    for r in range(len(data)):
        place = data1[r][0]
        establishment = data1[r][1]
        male = data1[r][3]
        female = data1[r][4]
        Tnepsk =  data1[r][6]
        Tpepsk = data1[r][7]
        poepsk = data1[r][-2]
        popepsk = data1[r][-1]
        list_place.append(place)
        list_establishments.append(establishment)
        list_male.append(male)
        list_female.append(female)
        list_Tnepsk.append(Tnepsk)
        list_Tpepsk.append(Tpepsk)
        list_poepsk.append(poepsk)
        list_popepsk.append(popepsk)
        list_ftomratio.append(list_female[r]/list_male[r])
        dic = {0: list_place, 1: list_establishments, 2: list_male,3: list_female, 4: list_Tnepsk, 5: list_Tpepsk, 6: list_poepsk, 7: list_popepsk, 8: list_ftomratio}
        """return (list_place, list_establishments, list_male, list_female, list_Tnepsk, list_Tpepsk, list_poepsk, list_popepsk)"""
        return dic

""" Analasying the collected data """

filename = "/home/malathi/Downloads/a001.xls"
def main():
    GetData(filename)
    if IsMaximumftomRatio(list_female, list_male):
       print (Location())
    location = input("choose a location")
    print(PoepskRatio(location))
main()

